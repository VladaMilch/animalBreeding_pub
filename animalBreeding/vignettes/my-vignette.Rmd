---
title: "Package 'animalBreeding'"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{my-vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Setup

For installation from GitHub, run the code below. 
Since the package repository is private at the moment, 
you need the `auth_token` argument.

```{r setup, message=FALSE}
library(devtools)
install_github("IMSBComputationalBiology/animalBreedingProj", 
               subdir="animalBreeding",
               auth_token = "f6024685998b779a9db258994a7b4e44468b754c", 
               force=TRUE)
library(animalBreeding)
```

# Usage

To reproduce Table 3.12 from the "Animal production and breeding" textbook, 
use the `calculate_needed_litters()` function. For instance, the number of 
litters required to give 97.5/% probability of achieving 25 animals, with the 
average litter size being 4, is 10.

```{r}
calculate_needed_litters_textbook(
    condifence_p = 0.975, 
    litter_mean = 4, 
    litter_sd = 2.5,
    n_needed = 25)
```

To reproduce Table 3.13 from the "Animal production and breeding" textbook, 
use the `calculate_needed_breedings()` function. For instance, the number of 
breedings required to give 97.5/% probability of achieving more than 10 litters, 
with the effective fertility being 15 percent, is 119 (according to the 
textbook). 


```{r}
calculate_needed_breedings_textbook(
    condifence_p = 0.975, 
    effective_fertility_p = 0.2, 
    n_litters = 15,
    calculation_type='textbook_exact')

```

The values I get when implementing the exact same model are slightly 
different, possibly due to the approximations the authors used, 
and the subtle difference between $P(x \leq X)$ and $P(x < X)$.

Thus, for the same figures as above, one would need 110 breedings but not 119.

```{r}
calculate_needed_breedings_textbook(
    condifence_p = 0.975, 
    effective_fertility_p = 0.15, 
    n_litters = 10,
    calculation_type='')

# probability to get 10 or more litters from 110 breedings
1 - pbinom(q = 9, size = 110, prob = 0.15)
# probability to get 10 or more litters from 109 breedings
1 - pbinom(q = 9, size = 109, prob = 0.15)
# thus, 110 is the minimal required number of breedings to have P>0.975
```
